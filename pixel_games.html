<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åƒç´ å¤§å†’é™© - å®ƒæ˜¯æ€ä¹ˆç»„æˆçš„ï¼Ÿ</title>
    <!-- ä½¿ç”¨ Tailwind CSS è¿›è¡Œå¿«é€Ÿç¾åŒ– -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap');

        body {
            font-family: 'ZCOOL KuaiLe', cursive, sans-serif; /* ä½¿ç”¨å¯çˆ±çš„å­—ä½“é£æ ¼ */
            background-color: #f0f9ff;
            background-image: radial-gradient(#bae6fd 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* åƒç´ åŒ–æ¸²æŸ“ï¼Œå…³é”® CSS */
        .pixelated {
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }

        .grid-cell {
            transition: transform 0.1s;
            cursor: pointer;
        }
        .grid-cell:hover {
            transform: scale(0.9);
            border: 2px solid rgba(0,0,0,0.2);
        }
        .grid-cell:active {
            transform: scale(0.8);
        }

        /* è‡ªå®šä¹‰æ»‘å—æ ·å¼ */
        input[type=range] {
            -webkit-appearance: none; 
            background: transparent; 
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 30px;
            width: 30px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            margin-top: -12px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 8px;
            cursor: pointer;
            background: #bfdbfe;
            border-radius: 5px;
        }
        
        /* é’ˆå¯¹ä»»åŠ¡ä¸‰çš„ä¸åŒé¢œè‰²æ»‘å— */
        #imagePixelSlider::-webkit-slider-thumb {
            background: #f59e0b; /* Amber-500 */
        }
        #imagePixelSlider::-webkit-slider-runnable-track {
            background: #fde68a; /* Amber-200 */
        }
    </style>
</head>
<body class="text-gray-800 select-none">

    <!-- é¡¶éƒ¨æ ‡é¢˜åŒº -->
    <header class="text-center py-8 px-4">
        <h1 class="text-5xl md:text-6xl text-blue-600 drop-shadow-md mb-4">ğŸ‘¾ åƒç´ å¤§å†’é™© ğŸ‘¾</h1>
        <p class="text-xl md:text-2xl text-gray-600 bg-white inline-block px-6 py-2 rounded-full shadow-lg border-2 border-blue-200">
            å›¾ç”»æ˜¯ç”±åƒä¸‡ä¸ªå°æ–¹å—ç»„æˆçš„ï¼
        </p>
    </header>

    <main class="max-w-4xl mx-auto px-4 space-y-12 pb-20">

        <!-- ç¬¬ä¸€è¯¾ï¼šä»€ä¹ˆæ˜¯åƒç´ ï¼Ÿï¼ˆè§‚å¯Ÿæ¨¡å¼ï¼‰ -->
        <section class="bg-white rounded-3xl p-6 md:p-8 shadow-xl border-b-8 border-blue-200">
            <div class="flex flex-col items-center">
                <h2 class="text-3xl text-purple-600 mb-6 flex items-center">
                    <span class="bg-purple-100 p-2 rounded-lg mr-3">ğŸ”</span> 
                    ä»»åŠ¡ä¸€ï¼šå˜èº«ä¾¦æ¢
                </h2>
                <p class="text-lg text-gray-500 mb-6 text-center">
                    è¿™çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªæ¸…æ™°çš„è˜‘è‡ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æŠŠå®ƒå˜å¾—å¾ˆå°ï¼Œå†å¼ºè¡Œæ”¾å¤§ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ<br>
                    <span class="text-blue-500 font-bold">æ‹–åŠ¨ä¸‹é¢çš„æ»‘å—è¯•è¯•çœ‹ï¼</span>
                </p>

                <!-- åƒç´ å˜æ¢å±•ç¤ºåŒº -->
                <div class="relative w-64 h-64 bg-gray-100 rounded-xl overflow-hidden border-4 border-gray-300 shadow-inner mb-6 flex items-center justify-center">
                    <!-- è¿™ä¸ª Canvas ç”¨æ¥åŠ¨æ€ç»˜åˆ¶ä½åˆ†è¾¨ç‡å›¾åƒ -->
                    <canvas id="pixelCanvas" width="8" height="8" class="pixelated w-full h-full object-contain"></canvas>
                    
                    <!-- åŸå§‹çš„é«˜æ¸… Emoji (ä½œä¸ºå‚è€ƒæˆ–æº) -->
                    <div id="sourceEmoji" style="display:none; font-size: 100px;">ğŸ„</div>
                </div>

                <div class="w-full max-w-md bg-blue-50 p-4 rounded-xl">
                    <div class="flex justify-between text-lg font-bold text-blue-800 mb-2">
                        <span>å…¨æ˜¯æ–¹å— (åƒç´ ä½)</span>
                        <span>å¾ˆæ¸…æ™° (åƒç´ é«˜)</span>
                    </div>
                    <input type="range" id="resolutionSlider" min="4" max="128" value="128" step="1" class="w-full">
                    <div class="text-center mt-2 text-xl text-blue-600">
                        å½“å‰æ–¹å—æ•°é‡ï¼š<span id="resValue" class="font-bold text-2xl">å¾ˆå¤š</span>
                    </div>
                </div>

                <div class="mt-6 bg-yellow-100 p-4 rounded-lg text-yellow-800 text-lg">
                    ğŸ’¡ <strong>å°çŸ¥è¯†ï¼š</strong> æ¯ä¸€ä¸ªå°è‰²å—å°±å«ä¸€ä¸ª <strong>â€œåƒç´ â€ (Pixel)â€</strong>ã€‚åƒæ­ç§¯æœ¨ä¸€æ ·ï¼Œæ–¹å—è¶Šå¤šï¼Œç”»å°±è¶Šæ¸…æ¥šï¼
                </div>
            </div>
        </section>

        <!-- ç¬¬äºŒè¯¾ï¼šæˆ‘æ¥ç”»åƒç´ ï¼ˆåˆ›é€ æ¨¡å¼ï¼‰ -->
        <section class="bg-white rounded-3xl p-6 md:p-8 shadow-xl border-b-8 border-green-200">
            <div class="flex flex-col items-center">
                <h2 class="text-3xl text-green-600 mb-6 flex items-center">
                    <span class="bg-green-100 p-2 rounded-lg mr-3">ğŸ¨</span>
                    ä»»åŠ¡äºŒï¼šæˆ‘æ˜¯å°ç”»å®¶
                </h2>
                <p class="text-lg text-gray-500 mb-6 text-center">
                    æ—¢ç„¶å›¾ç”»æ˜¯æ–¹å—ç»„æˆçš„ï¼Œé‚£æˆ‘ä»¬ä¹Ÿæ¥ç”¨æ–¹å—ç”»ç”»å§ï¼<br>
                    <span class="text-green-500 font-bold">ç‚¹å‡»ä¸‹é¢çš„æ ¼å­å¡«è‰²ã€‚</span>
                </p>

                <!-- é¢œè‰²é€‰æ‹©å™¨ -->
                <div class="flex gap-4 mb-6 bg-gray-100 p-3 rounded-full shadow-inner">
                    <button onclick="setColor('red')" class="w-12 h-12 rounded-full bg-red-500 hover:scale-110 transition ring-4 ring-transparent hover:ring-red-200 focus:ring-red-300 shadow-md transform active:scale-90" aria-label="çº¢è‰²"></button>
                    <button onclick="setColor('#3b82f6')" class="w-12 h-12 rounded-full bg-blue-500 hover:scale-110 transition ring-4 ring-transparent hover:ring-blue-200 focus:ring-blue-300 shadow-md transform active:scale-90" aria-label="è“è‰²"></button>
                    <button onclick="setColor('#22c55e')" class="w-12 h-12 rounded-full bg-green-500 hover:scale-110 transition ring-4 ring-transparent hover:ring-green-200 focus:ring-green-300 shadow-md transform active:scale-90" aria-label="ç»¿è‰²"></button>
                    <button onclick="setColor('#facc15')" class="w-12 h-12 rounded-full bg-yellow-400 hover:scale-110 transition ring-4 ring-transparent hover:ring-yellow-200 focus:ring-yellow-300 shadow-md transform active:scale-90" aria-label="é»„è‰²"></button>
                    <button onclick="setColor('black')" class="w-12 h-12 rounded-full bg-gray-900 hover:scale-110 transition ring-4 ring-transparent hover:ring-gray-300 focus:ring-gray-400 shadow-md transform active:scale-90" aria-label="é»‘è‰²"></button>
                    <!-- æ©¡çš®æ“¦ -->
                    <button onclick="setColor('white')" class="w-12 h-12 rounded-full bg-white border-2 border-gray-300 flex items-center justify-center hover:scale-110 transition shadow-md text-xl" title="æ©¡çš®æ“¦">ğŸ§½</button>
                </div>
                
                <div id="currentColorDisplay" class="mb-4 text-lg">
                    ç°åœ¨æ‰‹é‡Œæ‹¿çš„æ˜¯ï¼š<span class="font-bold px-3 py-1 rounded text-white shadow" style="background-color: red;">çº¢è‰²</span>
                </div>

                <!-- 10x10 ç”»å¸ƒ -->
                <div id="pixelGrid" class="grid grid-cols-10 gap-0.5 bg-gray-300 p-1 rounded border-4 border-gray-400 shadow-lg" style="width: 320px; height: 320px;">
                    <!-- æ ¼å­å°†é€šè¿‡ JS ç”Ÿæˆ -->
                </div>

                <div class="flex gap-4 mt-6">
                    <button onclick="clearGrid()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-3 px-6 rounded-full transition shadow-md">
                        ğŸ—‘ï¸ å…¨éƒ¨æ“¦æ‰
                    </button>
                </div>
            </div>
        </section>

        <!-- ç¬¬ä¸‰è¯¾ï¼šä¸‡ç‰©çš†åƒç´  (ä¸Šä¼ æ¨¡å¼) -->
        <section class="bg-white rounded-3xl p-6 md:p-8 shadow-xl border-b-8 border-yellow-400">
            <div class="flex flex-col items-center">
                <h2 class="text-3xl text-yellow-600 mb-6 flex items-center">
                    <span class="bg-yellow-100 p-2 rounded-lg mr-3">ğŸ“¸</span>
                    ä»»åŠ¡ä¸‰ï¼šä¸‡ç‰©çš†åƒç´ 
                </h2>
                <p class="text-lg text-gray-500 mb-6 text-center">
                    ä½ å¯ä»¥ä¸Šä¼ ä¸€å¼ è‡ªå·±çš„ç…§ç‰‡ï¼Œçœ‹çœ‹å®ƒå˜æˆåƒç´ ç”»æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼<br>
                    <span class="text-orange-500 font-bold">ä¸€å¼€å§‹æ˜¯æ¸…æ™°çš„ï¼Œå¾€å·¦æ‹–åŠ¨è®©å®ƒâ€œå˜æ–¹â€ï¼</span>
                </p>

                <!-- ä¸Šä¼ æ§ä»¶ -->
                <div class="mb-6 w-full max-w-md">
                    <label class="block w-full flex flex-col items-center px-4 py-6 bg-orange-50 text-orange-500 rounded-xl shadow-lg tracking-wide uppercase border border-orange-200 cursor-pointer hover:bg-orange-100 transition active:scale-95">
                        <span class="text-4xl mb-2">ğŸ“¤</span>
                        <span class="text-xl leading-normal font-bold">ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡</span>
                        <input type='file' class="hidden" id="uploadInput" accept="image/*" />
                    </label>
                </div>

                <!-- åƒç´ æ§åˆ¶ (é»˜è®¤éšè—ï¼Œä¸Šä¼ åæ˜¾ç¤º) -->
                <div class="w-full max-w-md bg-yellow-50 p-4 rounded-xl mb-6 hidden transition-all duration-500" id="pixelControlArea">
                    <div class="flex justify-between text-lg font-bold text-yellow-800 mb-2">
                        <span>æ–¹å—å¤§ (åƒç´ é£)</span>
                        <span>æ–¹å—å° (é«˜æ¸…)</span>
                    </div>
                    <!-- é»˜è®¤å€¼è®¾ä¸º 100ï¼Œä¸€å¼€å§‹å°±æ˜¯é«˜æ¸… -->
                    <input type="range" id="imagePixelSlider" min="1" max="100" value="100" step="1" class="w-full">
                    <div class="text-center mt-2 text-xl text-yellow-700">
                        ç…§ç‰‡æ ·å­ï¼š<span id="imgResText" class="font-bold text-2xl">é«˜æ¸…ç…§ç‰‡</span>
                    </div>
                </div>

                <!-- å›¾ç‰‡å±•ç¤ºåŒº -->
                <div class="relative w-full max-w-md bg-gray-100 rounded-xl overflow-hidden border-4 border-gray-300 shadow-inner min-h-[300px] flex items-center justify-center">
                    <div id="imgPlaceholder" class="text-center p-4">
                        <span class="text-6xl block mb-2">ğŸ–¼ï¸</span>
                        <p class="text-gray-400 text-xl">å›¾ç‰‡ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ</p>
                    </div>
                    <!-- å›¾ç‰‡ Canvas -->
                    <canvas id="imageCanvas" class="pixelated w-full h-auto hidden"></canvas>
                </div>
            </div>
        </section>

    </main>

    <!-- è„šæœ¬é€»è¾‘ -->
    <script>
        /* ------------------ ä»»åŠ¡ä¸€ï¼šåƒç´ å˜ç„¦é€»è¾‘ ------------------ */
        const canvas = document.getElementById('pixelCanvas');
        const ctx = canvas.getContext('2d');
        const slider = document.getElementById('resolutionSlider');
        const resValue = document.getElementById('resValue');
        
        // ç¦ç”¨å¹³æ»‘å¤„ç†ï¼Œç¡®ä¿åƒç´ çœ‹èµ·æ¥æ˜¯æ–¹æ–¹æ­£æ­£çš„
        ctx.imageSmoothingEnabled = false;

        // æˆ‘ä»¬è¦ç”»çš„ Emoji
        const emoji = "ğŸ„";
        
        function drawPixelated(resolution) {
            // 1. è®¾ç½® Canvas çš„å®é™…åˆ†è¾¨ç‡ï¼ˆæ¯”å¦‚ 8x8 æˆ– 64x64ï¼‰
            canvas.width = resolution;
            canvas.height = resolution;
            
            // 2. å†æ¬¡ç¡®ä¿å…³é—­å¹³æ»‘ï¼ˆæœ‰äº›æµè§ˆå™¨é‡ç½®å®½é«˜åä¼šé‡ç½®æ­¤å±æ€§ï¼‰
            ctx.imageSmoothingEnabled = false;

            // 3. åœ¨è¿™ä¸ªå°å°çš„ç”»å¸ƒä¸Šç”»ä¸€ä¸ªå·¨å¤§çš„ Emoji
            // å­—ä½“å¤§å°éœ€è¦åŒ¹é…ç”»å¸ƒå¤§å°ï¼Œç”šè‡³ç¨å¾®å¤§ä¸€ç‚¹ä»¥å¡«æ»¡
            ctx.font = `${resolution * 0.9}px serif`;
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            
            // å¡«å……èƒŒæ™¯ä»¥é˜²é€æ˜
            ctx.fillStyle = "#e0f2fe"; 
            ctx.fillRect(0, 0, resolution, resolution);
            
            // ç”» Emoji
            ctx.fillText(emoji, resolution / 2, resolution / 1.8);

            // æ›´æ–°æ–‡å­—è¯´æ˜
            if (resolution < 10) {
                resValue.innerText = "å¾ˆå°‘ (çœ‹ä¸æ¸…å•¦!)";
                resValue.className = "font-bold text-2xl text-red-500";
            } else if (resolution < 40) {
                resValue.innerText = "ä¸€ç‚¹ç‚¹ (é©¬èµ›å…‹)";
                resValue.className = "font-bold text-2xl text-yellow-600";
            } else {
                resValue.innerText = "å¾ˆå¤š (è¶…çº§æ¸…æ¥š!)";
                resValue.className = "font-bold text-2xl text-green-600";
            }
        }

        // ç›‘å¬æ»‘å—
        slider.addEventListener('input', (e) => {
            drawPixelated(parseInt(e.target.value));
        });

        // åˆå§‹åŒ–
        drawPixelated(128);


        /* ------------------ ä»»åŠ¡äºŒï¼šç»˜ç”»æ¿é€»è¾‘ ------------------ */
        const grid = document.getElementById('pixelGrid');
        const colorDisplay = document.querySelector('#currentColorDisplay span');
        let currentColor = 'red';
        let isDrawing = false; // æ”¯æŒæ‹–æ‹½ç»˜ç”»

        // ç”Ÿæˆ 10x10 = 100 ä¸ªæ ¼å­
        function initGrid() {
            grid.innerHTML = '';
            for (let i = 0; i < 100; i++) {
                const cell = document.createElement('div');
                cell.className = 'grid-cell bg-white w-full h-full';
                cell.dataset.index = i;
                
                // ç‚¹å‡»å˜è‰²
                cell.addEventListener('mousedown', () => {
                    cell.style.backgroundColor = currentColor;
                });
                
                // é¼ æ ‡æ»‘è¿‡å˜è‰²ï¼ˆå¦‚æœæŒ‰ä½çš„è¯ï¼‰
                cell.addEventListener('mouseenter', () => {
                    if (isDrawing) {
                        cell.style.backgroundColor = currentColor;
                    }
                });

                // ç§»åŠ¨ç«¯è§¦æ‘¸æ”¯æŒ
                cell.addEventListener('touchstart', (e) => {
                    e.preventDefault(); // é˜²æ­¢æ»šåŠ¨
                    cell.style.backgroundColor = currentColor;
                });

                grid.appendChild(cell);
            }
        }

        // å…¨å±€é¼ æ ‡çŠ¶æ€ç›‘å¬ï¼Œç”¨äºæ‹–æ‹½ç»˜ç”»
        document.body.addEventListener('mousedown', () => isDrawing = true);
        document.body.addEventListener('mouseup', () => isDrawing = false);

        // é€‰è‰²åŠŸèƒ½
        window.setColor = function(color) {
            currentColor = color;
            
            // æ›´æ–°æ–‡å­—æç¤º
            if(color === 'red') { colorDisplay.innerText = "çº¢è‰²"; colorDisplay.style.backgroundColor = "red"; colorDisplay.style.color = "white"; }
            else if(color === '#3b82f6') { colorDisplay.innerText = "è“è‰²"; colorDisplay.style.backgroundColor = "#3b82f6"; colorDisplay.style.color = "white"; }
            else if(color === '#22c55e') { colorDisplay.innerText = "ç»¿è‰²"; colorDisplay.style.backgroundColor = "#22c55e"; colorDisplay.style.color = "white"; }
            else if(color === '#facc15') { colorDisplay.innerText = "é»„è‰²"; colorDisplay.style.backgroundColor = "#facc15"; colorDisplay.style.color = "black"; }
            else if(color === 'black') { colorDisplay.innerText = "é»‘è‰²"; colorDisplay.style.backgroundColor = "black"; colorDisplay.style.color = "white"; }
            else if(color === 'white') { colorDisplay.innerText = "æ©¡çš®æ“¦"; colorDisplay.style.backgroundColor = "white"; colorDisplay.style.color = "black"; colorDisplay.style.border = "1px solid #ccc"; }
        }

        // æ¸…ç©ºç”»å¸ƒ
        window.clearGrid = function() {
            const cells = document.querySelectorAll('.grid-cell');
            cells.forEach(cell => {
                cell.style.backgroundColor = 'white';
                cell.style.transform = "scale(1)"; // é‡ç½®åŠ¨ç”»çŠ¶æ€
            });
            // ç®€å•çš„åŠ¨ç”»åé¦ˆ
            grid.classList.add('animate-pulse');
            setTimeout(() => grid.classList.remove('animate-pulse'), 500);
        }

        initGrid();

        /* ------------------ ä»»åŠ¡ä¸‰ï¼šå›¾ç‰‡åƒç´ åŒ–é€»è¾‘ ------------------ */
        const uploadInput = document.getElementById('uploadInput');
        const imageCanvas = document.getElementById('imageCanvas');
        const imageCtx = imageCanvas.getContext('2d');
        const imgSlider = document.getElementById('imagePixelSlider');
        const imgResText = document.getElementById('imgResText');
        const imgPlaceholder = document.getElementById('imgPlaceholder');
        const pixelControlArea = document.getElementById('pixelControlArea');

        let userImg = new Image();

        // ç›‘å¬æ–‡ä»¶ä¸Šä¼ 
        uploadInput.addEventListener('change', handleFile);

        function handleFile(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (event) => {
                userImg = new Image();
                userImg.onload = () => {
                    // å›¾ç‰‡åŠ è½½å®Œæˆåï¼Œæ˜¾ç¤ºæ§åˆ¶åŒºå’Œ Canvas
                    imgPlaceholder.style.display = 'none';
                    imageCanvas.classList.remove('hidden');
                    pixelControlArea.classList.remove('hidden');
                    // é‡ç½®æ»‘å—åˆ° 100 (æœ€æ¸…æ™°)
                    imgSlider.value = 100;
                    processUserImage();
                };
                userImg.src = event.target.result;
            };
            reader.readAsDataURL(file);
        }

        // ç›‘å¬æ»‘å—
        imgSlider.addEventListener('input', processUserImage);

        function processUserImage() {
            if (!userImg.width) return;
            
            // è·å–æ»‘å—å€¼ (1-100)
            const val = parseInt(imgSlider.value);
            
            // æ–°çš„ç¼©æ”¾é€»è¾‘ï¼š
            // 1. å¦‚æœæ˜¯ 100ï¼Œç›´æ¥ä½¿ç”¨ 1.0 (åŸå›¾)
            // 2. å¦‚æœå°äº 100ï¼Œä½¿ç”¨å¹³æ–¹æ›²çº¿ (scale = (val/100)^2) 
            //    è¿™æ ·å¯ä»¥è®©ä½æ•°å€¼åŒºé—´æ›´å¯†é›†ï¼Œæ›´å®¹æ˜“è°ƒèŠ‚å‡ºâ€œå¤§æ–¹å—â€æ•ˆæœï¼Œä¸”æœ€ä½èƒ½åˆ°éå¸¸å°çš„å°ºå¯¸
            
            let scale;
            if (val === 100) {
                scale = 1;
            } else {
                // ä½¿ç”¨å¹³æ–¹ï¼Œä½¿å¾—å·¦ä¾§çš„â€œåƒç´ åŒ–â€åŒºé—´æ›´å¹¿ï¼Œä¸‹é™æ›´å¿«
                // ä¾‹å¦‚ï¼š50%çš„ä½ç½® -> 0.25 (1/4 å°ºå¯¸)
                //      10%çš„ä½ç½® -> 0.01 (1/100 å°ºå¯¸)
                scale = Math.pow(val / 100, 2); 
            }

            // è®¡ç®—â€œä½åƒç´ â€æ—¶çš„å°ºå¯¸ï¼Œæœ€å°‘ä¿ç•™ 2x2 åƒç´ ï¼Œé˜²æ­¢æŠ¥é”™æˆ–å®Œå…¨æ¶ˆå¤±
            const w = Math.max(2, Math.floor(userImg.width * scale));
            const h = Math.max(2, Math.floor(userImg.height * scale));
            
            imageCanvas.width = userImg.width;
            imageCanvas.height = userImg.height;
            imageCtx.imageSmoothingEnabled = false;
            
            // 1. ç¼©å° (ä¸¢å¤±ç»†èŠ‚)
            const tempCanvas = document.createElement('canvas');
            tempCanvas.width = w;
            tempCanvas.height = h;
            const tempCtx = tempCanvas.getContext('2d');
            tempCtx.drawImage(userImg, 0, 0, w, h);
            
            // 2. æ”¾å¤§ (æ˜¾ç¤ºé”¯é½¿)
            imageCtx.drawImage(tempCanvas, 0, 0, w, h, 0, 0, imageCanvas.width, imageCanvas.height);
            
            // æ›´æ–°æ–‡æœ¬
            if (val === 100) {
                imgResText.innerText = "é«˜æ¸…ç…§ç‰‡ (åƒé•œå­ä¸€æ ·)";
                imgResText.className = "font-bold text-2xl text-green-600";
            }
            else if (val > 80) {
                imgResText.innerText = "ç¨å¾®æ¨¡ç³Š (æœ‰ç‚¹å¤±çœŸ)";
                imgResText.className = "font-bold text-2xl text-green-500";
            }
            else if (val > 50) {
                imgResText.innerText = "å¤å¤æ¸¸æˆé£ (åƒç´ å¯è§)";
                imgResText.className = "font-bold text-2xl text-yellow-600";
            }
            else if (val > 20) {
                imgResText.innerText = "è¶…çº§é©¬èµ›å…‹ (æ–¹å—å¾ˆå¤§)";
                imgResText.className = "font-bold text-2xl text-orange-500";
            }
            else {
                imgResText.innerText = "å®Œå…¨å´©è§£ (çœ‹ä¸å‡ºæ¥å•¦)";
                imgResText.className = "font-bold text-2xl text-red-600";
            }
        }

    </script>
</body>
</html>
